---
title: "P8105 HW3"
output: github_document
date: "2024-10-09"
---

```{r setup, include=FALSE}
library(tidyverse)
library(dplyr)
library(rnoaa)
library(dplyr)
library(ggplot2)
library(readr)
library(janitor)
```

```{r}
library(p8105.datasets)
data("ny_noaa")
```

## Problem 1 

```{r}
ny_noaa_updated = 
  (ny_noaa %>%
mutate(
    date = as.Date(date),
    year = year(date),
    month = month(date),
    day = day(date),  
    tmax = as.numeric(tmax),
    tmin = as.numeric(tmin),
    prcp = as.numeric(prcp),
    snow = as.numeric(snow)))
```

In the ny_noaa dataset, we observe weather patterns (precipation, snowfall, snow depth) from numerous stations in New York. The variables identified are: (station) id, date, tmax (max temp in F), tmin (min temp in F), prcp (precipation), and snow (fall). The most commonly observed snowfall values are 0 or NA indicating that there is a large majority of stations that do not have snowfall. 

```{r}
snowfall_values <- ny_noaa_updated %>%
  group_by(snow) %>%
  summarise(count = n()) %>%
  arrange(desc(count))

print(snowfall_values)
```

```{r}
temp_station = ny_noaa_updated %>%
  mutate(month = case_when(
    id == "January" ~ "January",
    id == "July" ~ "July",
    TRUE ~ NA_character_  
  )) 

print(temp_station)
```

## Problem 2 

```{r}
library(tidyverse)
library(haven)
library(janitor)
library(dplyr)

covar_df <- read_csv("./data/nhanes_covar.csv")
accel_df <- read_csv("./data/nhanes_accel.csv")

colnames(covar_df) <- c("SEQN", "sex", "age", "BMI", "education")

covar_df <- covar_df |>
  clean_names()

accel_df <- accel_df |> 
  clean_names()
```

```{r}
covar_df <- covar_df |>
  filter(age >= 21) |>
  drop_na() |>
  mutate(
    sex = 
      case_match(
        sex, 
        1 ~ "male", 
        2 ~ "female"),
    sex = as.factor(sex),
    education= 
      case_match(
        education, 
        1 ~ "Less than high school", 
        2 ~ "High School",
        3 ~ "More than high school"), 
    education = as.factor(education))

accel_df <- accel_df |>
  drop_na()

accel_df = 
  pivot_longer(
    accel_df, 
    starts_with("min"),
    names_to = "minutes", 
    values_to = "min")

covar_accel_df = 
  left_join(covar_df, accel_df, by = "seqn")

print(covar_accel_df)
```

## Problem 3 

```{r}
jan_2020_citibike = 
  read_csv("citibike/Jan 2020 Citi.csv", show_col_types = FALSE) %%
  janitor::clean_names() %% 
  rename(ride_id = id, start_station_name = start, end_station = end, member_casual = member_casual, duration = duration, rideable_type = type)
```


