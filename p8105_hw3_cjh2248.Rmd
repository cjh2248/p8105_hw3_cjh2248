---
title: "P8105 HW3"
output: github_document
date: "2024-10-09"
---

```{r setup, include=FALSE}
library(tidyverse)
library(dplyr)
library(rnoaa)
library(dplyr)
library(ggplot2)
library(readr)
library(janitor)
```

```{r}
library(p8105.datasets)
data("ny_noaa")
```

## Problem 1 

```{r}
ny_noaa_updated = 
  (ny_noaa %>%
mutate(
    date = as.Date(date),
    year = year(date),
    month = month(date),
    day = day(date),  
    tmax = as.numeric(tmax),
    tmin = as.numeric(tmin),
    prcp = as.numeric(prcp),
    snow = as.numeric(snow)))
```

In the ny_noaa dataset, we observe weather patterns (precipation, snowfall, snow depth) from numerous stations in New York. The variables identified are: (station) id, date, tmax (max temp in F), tmin (min temp in F), prcp (precipation), and snow (fall). The most commonly observed snowfall values are 0 or NA indicating that there is a large majority of stations that do not have snowfall. 

```{r}
snowfall_values <- ny_noaa_updated %>%
  group_by(snow) %>%
  summarise(count = n()) %>%
  arrange(desc(count))

print(snowfall_values)
```

```{r}
temp_station = ny_noaa_updated %>%
  mutate(month = case_when(
    id == "January" ~ "January",
    id == "July" ~ "July",
    TRUE ~ NA_character_  
  )) 

print(temp_station)
```

## Problem 2 

```{r}
library(tidyverse)
library(haven)
library(janitor)
library(dplyr)

covar_df <- read_csv("./data/nhanes_covar.csv")
accel_df <- read_csv("./data/nhanes_accel.csv")

colnames(covar_df) <- c("SEQN", "sex", "age", "BMI", "education")

covar_df <- covar_df |>
  clean_names()

accel_df <- accel_df |> 
  clean_names()
```

```{r}
covar_df <- covar_df |>
  filter(age >= 21) |>
  drop_na() |>
  mutate(
    sex = 
      case_match(
        sex, 
        1 ~ "male", 
        2 ~ "female"),
    sex = as.factor(sex),
    education= 
      case_match(
        education, 
        1 ~ "Less than high school", 
        2 ~ "High School",
        3 ~ "More than high school"), 
    education = as.factor(education))

accel_df <- accel_df |>
  drop_na()

accel_df = 
  pivot_longer(
    accel_df, 
    starts_with("min"),
    names_to = "minutes", 
    values_to = "min")

covar_accel_df = 
  left_join(covar_df, accel_df, by = "seqn")

print(covar_accel_df)
```

For this problem, I used the clean_names function to tidy the data and began to filter the age for the covar_df less than 21 years of age. One thing to note that I am missing in my code is the skip 4 lines function. I did not do this because I had already removed the first 4 rows when I loaded the data into the project. I spoke with someone during office hours and they strongly advised me to not do that for future assignments as I might get deducted points. Hopefully, this clarifies a bit of my work. 

Additionally, I used case_match to sort through the numeric values representing sex to characters. For the accel_df, I used the pivot_longer tool to combine all the columns representing minutes. After that, I combined the two datasets together. 

```{r}
library(ggridges)

ggplot(covar_accel_df, aes(x = age, fill = sex)) + 
  geom_histogram(binwidth = 5, position = "dodge") + 
  facet_wrap(~ education) +
  labs(title = "Age Distribution by Education Level and Sex", 
       x = "Age", 
       y = "Count",
       fill = "Sex") +
  theme_minimal()
```





## Problem 3 

```{r}
jan_2020_citibike = 
  read_csv("citibike/Jan 2020 Citi.csv", show_col_types = FALSE) |>
  clean_names() |>
  drop_na() 
```


